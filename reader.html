<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…ÙƒØªØ¨Ø© Ø´ÙŠÙ† - Ù‚Ø§Ø±Ø¦ Ø§Ù„Ø±ÙˆØ§ÙŠØ§Øª</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@600&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #f4f1ea; --text: #2c3e50; --size: 1.25rem; }
        body.dark-mode { --bg: #1a1a1b; --text: #d5d5d5; }
        body.sepia-mode { --bg: #f4f1ea; --text: #433422; }

        body { 
            margin: 0; padding: 0; background: var(--bg); color: var(--text); 
            font-family: 'Amiri', serif; transition: 0.3s; overflow: hidden; 
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .toolbar { 
            height: 60px; display: flex; align-items: center; justify-content: space-around;
            background: rgba(255,255,255,0.1); backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0,0,0,0.1); position: fixed; top: 0; width: 100%; z-index: 10;
        }
        .btn { cursor: pointer; padding: 8px 15px; border-radius: 12px; font-family: 'Cairo'; font-size: 12px; border: 1px solid #ccc; background: white; color: #333; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø¨Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© (Ø§Ù„Ø¥ÙŠÙÙƒØª Ø§Ù„Ù„ÙŠ Ø³Ø£Ù„Øª Ø¹Ù†Ù‡) */
        #book-viewport {
            margin-top: 70px;
            height: calc(100vh - 120px);
            padding: 0 5%;
            column-width: 90vw; /* Ø¨ÙŠØ®Ù„ÙŠ ÙƒÙ„ "ØµÙØ­Ø©" Ø¨Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø§Ø´Ø© */
            column-gap: 10vw;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: justify;
        }

        #content {
            font-size: var(--size);
            line-height: 2.2;
            white-space: pre-line;
        }

        /* Ø¥ÙŠÙÙƒØª Ø§Ù„ÙÙ‚Ø±Ø§Øª Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ */
        #content p { margin-bottom: 1.5em; text-indent: 1.5em; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø³ÙÙ„ÙŠ ÙˆØ§Ù„ØªÙ‚Ø¯Ù… */
        .bottom-bar {
            position: fixed; bottom: 0; width: 100%; height: 50px;
            display: flex; align-items: center; justify-content: center;
            font-family: 'Cairo'; font-size: 14px; background: rgba(0,0,0,0.05);
        }
        #progress { position: absolute; top: 0; left: 0; height: 3px; background: #e67e22; transition: 0.3s; }
    </style>
</head>
<body class="sepia-mode">

    <div class="toolbar">
        <div class="btn" onclick="location.href='index.html'">ğŸ  Ø®Ø±ÙˆØ¬</div>
        <div class="btn" onclick="setMode('dark')">ğŸŒ™</div>
        <div class="btn" onclick="setMode('sepia')">ğŸ“œ</div>
        <div class="btn" onclick="changeFontSize(0.1)">A+</div>
        <div class="btn" onclick="changeFontSize(-0.1)">A-</div>
    </div>

    <div id="book-viewport">
        <div id="content">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± ØµÙØ­Ø§Øª Ø§Ù„Ø±ÙˆØ§ÙŠØ©...</div>
    </div>

    <div class="bottom-bar">
        <div id="progress"></div>
        <span id="page-info">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...</span>
    </div>

    <script>
        async function loadBook() {
            const params = new URLSearchParams(window.location.search);
            const book = params.get('book');
            if(!book) return;

            try {
                const res = await fetch(`${book}.txt`);
                const text = await res.text();
                // ÙˆØ¶Ø¹ Ø§Ù„Ù†Øµ Ø¯Ø§Ø®Ù„ ÙÙ‚Ø±Ø§Øª Ù„ÙŠØ¹Ù…Ù„ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ
                document.getElementById('content').innerHTML = text.split('\n').map(p => `<p>${p}</p>`).join('');
                document.getElementById('page-info').innerText = "ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ - Ø§Ø³Ø­Ø¨ Ù„Ù„ÙŠÙ…ÙŠÙ† Ø£Ùˆ Ø§Ù„ÙŠØ³Ø§Ø±";
            } catch(e) {
                document.getElementById('content').innerText = "Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù.";
            }
        }

        function setMode(m) { document.body.className = m + '-mode'; }
        
        let sz = 1.25;
        function changeFontSize(d) {
            sz += d;
            document.documentElement.style.setProperty('--size', sz + 'rem');
        }

        // Ø¥ÙŠÙÙƒØª Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨Ø§Ù„Ù„Ù…Ø³ (Swipe)
        let startX = 0;
        let currentPos = 0;
        window.addEventListener('touchstart', e => startX = e.touches[0].clientX);
        window.addEventListener('touchend', e => {
            let endX = e.changedTouches[0].clientX;
            let diff = startX - endX;
            let view = document.getElementById('book-viewport');
            
            if(Math.abs(diff) > 50) { // Ù„Ùˆ Ø§Ù„Ø³Ø­Ø¨Ø© ÙƒØ§ÙÙŠØ©
                if(diff > 0) currentPos -= 100; // Ù„Ù„ÙŠØ³Ø§Ø±
                else currentPos += 100; // Ù„Ù„ÙŠÙ…ÙŠÙ†
                
                if(currentPos > 0) currentPos = 0;
                view.style.transform = `translateX(${currentPos}vw)`;
            }
        });

        window.onload = loadBook;
    </script>
</body>
</html>
